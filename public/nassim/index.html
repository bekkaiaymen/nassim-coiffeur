<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#FDB714">
    <meta name="description" content="ØµØ§Ù„ÙˆÙ† nassim - Ø§Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯Ùƒ ÙÙŠ Ø£ÙØ¶Ù„ ØµØ§Ù„ÙˆÙ† Ø­Ù„Ø§Ù‚Ø©">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Nassim Coiffeur">
    
    <!-- Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Icons -->
    <link rel="icon" type="image/svg+xml" href="/nassim/favicon.svg">
    <link rel="icon" type="image/x-icon" href="/nassim/favicon.svg">
    <link rel="shortcut icon" type="image/x-icon" href="/nassim/favicon.svg">
    <link rel="icon" href="/nassim/logo.jpg">
    <link rel="apple-touch-icon" href="/nassim/logo.jpg">
    
    <title>âœ‚ï¸ Nassim Coiffeur - ØµØ§Ù„ÙˆÙ† Ø§Ù„Ø­Ù„Ø§Ù‚Ø© Ø§Ù„Ø£ÙˆÙ„</title>
    <link rel="stylesheet" href="/nassim/nassim.css">
    <link rel="stylesheet" href="/nassim/timeline-rating.css">
    <link rel="stylesheet" href="/nassim/timeline-new.css">
    <link rel="stylesheet" href="/nassim/ai-wassim.css">
    <link rel="stylesheet" href="/nassim/ai-stylist.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    
    <!-- Preload Critical Script -->
    <script>
        // Define function IMMEDIATELY before any other scripts
        console.log('ğŸš€ INLINE v011 - Defining Intelligent Schedule-Based Suggest');
        
        // Helper to get selected services from the page
        function getSelectedServicesFromPage() {
            const container = document.getElementById('selectedServices');
            if (!container || container.style.display === 'none') {
                console.log('â„¹ï¸ No services selected yet');
                return [];
            }
            
            // Try to access from window if available
            if (window.nassimState?.selectedServices) {
                return window.nassimState.selectedServices;
            }
            
            return [];
        }
        
        // Get employee weekly schedule from API
        async function getEmployeeSchedule(API_URL, businessId, employeeId) {
            try {
                const url = `${API_URL}/employees/${employeeId}`;
                console.log(`ğŸ“‹ Fetching employee schedule: ${url}`);
                
                // Try with auth token if available
                const token = localStorage.getItem('customerToken');
                const headers = token ? { 'Authorization': `Bearer ${token}` } : {};
                
                const response = await fetch(url, { headers });
                if (!response.ok) {
                    console.log('âš ï¸ Employee schedule not available, will use slot-based search');
                    return null;
                }
                
                const result = await response.json();
                if (result.success && result.data && result.data.workingHours) {
                    console.log(`âœ… Employee schedule loaded:`, result.data.workingHours);
                    return result.data.workingHours;
                }
            } catch (error) {
                console.log('âš ï¸ Could not load schedule, continuing with slot-based search');
            }
            return null;
        }
        
        // Find first available slot in employee's working hours
        function findFirstAvailableInSchedule(schedule, dayOfWeek, currentTime = null) {
            const days = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
            const dayName = days[dayOfWeek];
            
            if (!schedule || !schedule[dayName] || !schedule[dayName].enabled) {
                console.log(`âš ï¸ Employee not working on ${dayName}`);
                return null;
            }
            
            const workDay = schedule[dayName];
            const startTime = workDay.start; // e.g., "09:00"
            const endTime = workDay.end;     // e.g., "18:00"
            
            console.log(`ğŸ“… ${dayName}: ${startTime} - ${endTime}`);
            
            // If checking today and we have current time, start from next available slot
            if (currentTime) {
                const [currentHour, currentMinute] = currentTime.split(':').map(Number);
                const [startHour, startMinute] = startTime.split(':').map(Number);
                
                const currentMinutes = currentHour * 60 + currentMinute;
                const startMinutes = startHour * 60 + startMinute;
                
                // If current time is before work start, return work start time
                if (currentMinutes < startMinutes) {
                    return startTime;
                }
                
                // Otherwise, round up to next 30-minute slot
                const nextSlotMinutes = Math.ceil((currentMinutes + 30) / 30) * 30;
                const nextHour = Math.floor(nextSlotMinutes / 60);
                const nextMinute = nextSlotMinutes % 60;
                
                const suggestedTime = `${String(nextHour).padStart(2, '0')}:${String(nextMinute).padStart(2, '0')}`;
                
                // Check if suggested time is within working hours
                const [endHour] = endTime.split(':').map(Number);
                if (nextHour < endHour || (nextHour === endHour && nextMinute === 0)) {
                    return suggestedTime;
                }
                
                return null; // No time left today
            }
            
            return startTime; // Return start of work day
        }
        
        window.suggestNearestAppointment = async function() {
            const API_URL = window.location.hostname === 'localhost' 
                ? 'http://localhost:3000/api'
                : 'https://nassim-coiffeur.onrender.com/api';
            const NASSIM_BUSINESS_ID = '69259331651b1babc1eb83dc';
            
            console.log('ğŸš€ [Suggest] Smart Function called');
            
            const dateInput = document.getElementById('appointmentDate');
            const timeInput = document.getElementById('appointmentTime');
            const employeeSelect = document.getElementById('employeeSelect');
            const btn = document.getElementById('suggestBtn');

            if (!dateInput || !timeInput) {
                console.error('âŒ [Suggest] Required form elements not found');
                alert('Ø®Ø·Ø£: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬');
                return;
            }

            // Wait a bit for nassimState to be available
            await new Promise(resolve => setTimeout(resolve, 100));

            // 1. Calculate Required Duration
            const services = getSelectedServicesFromPage();
            const totalDuration = services.reduce((sum, s) => sum + (s.duration || 30), 0) || 30;
            const slotsNeeded = Math.ceil(totalDuration / 30);
            
            console.log(`â±ï¸ [Suggest] Selected services:`, services);
            console.log(`â±ï¸ [Suggest] Required Duration: ${totalDuration}min (${slotsNeeded} slots)`);

            if (btn) {
                btn.disabled = true;
                btn.innerHTML = `â³ Ù†Ø¨Ø­Ø« Ø¹Ù† ${totalDuration} Ø¯Ù‚ÙŠÙ‚Ø©...`;
                btn.style.opacity = '0.6';
            }

            const timeToMinutes = (timeStr) => {
                const [h, m] = timeStr.split(':').map(Number);
                return h * 60 + m;
            };

            try {
                const now = new Date();
                const currentHour = now.getHours();
                const currentMinute = now.getMinutes();
                const currentTime = `${String(currentHour).padStart(2, '0')}:${String(currentMinute).padStart(2, '0')}`;
                const currentTotalMinutes = currentHour * 60 + currentMinute;
                const maxDaysToCheck = 14;
                
                // Get employee ID
                const employeeId = employeeSelect && employeeSelect.value && employeeSelect.value !== 'any' ? employeeSelect.value : '';
                
                // Load employee schedule if specific employee selected
                let employeeSchedule = null;
                if (employeeId) {
                    console.log(`ğŸ‘¤ Loading schedule for employee: ${employeeId}`);
                    employeeSchedule = await getEmployeeSchedule(API_URL, NASSIM_BUSINESS_ID, employeeId);
                }
                
                for (let dayOffset = 0; dayOffset < maxDaysToCheck; dayOffset++) {
                    const checkDate = new Date(now);
                    checkDate.setDate(checkDate.getDate() + dayOffset);
                    const dateStr = checkDate.toISOString().split('T')[0];
                    const dayOfWeek = checkDate.getDay();
                    const isToday = (dayOffset === 0);

                    console.log(`ğŸ” [Day +${dayOffset}] ${dateStr} (${['Ø£Ø­Ø¯', 'Ø¥Ø«Ù†ÙŠÙ†', 'Ø«Ù„Ø§Ø«Ø§Ø¡', 'Ø£Ø±Ø¨Ø¹Ø§Ø¡', 'Ø®Ù…ÙŠØ³', 'Ø¬Ù…Ø¹Ø©', 'Ø³Ø¨Øª'][dayOfWeek]})`);

                    // If we have employee schedule, check if they work this day
                    let suggestedStartTime = null;
                    if (employeeSchedule) {
                        suggestedStartTime = findFirstAvailableInSchedule(
                            employeeSchedule, 
                            dayOfWeek, 
                            isToday ? currentTime : null
                        );
                        
                        if (!suggestedStartTime) {
                            console.log(`â­ï¸ Employee not working on this day, skipping...`);
                            continue;
                        }
                        
                        console.log(`ğŸ’¡ Suggested start time from schedule: ${suggestedStartTime}`);
                    }

                    let apiUrl = `${API_URL}/appointments/available-slots?business=${NASSIM_BUSINESS_ID}&date=${dateStr}`;
                    if (employeeId) {
                        apiUrl += `&employee=${employeeId}`;
                    }
                    const response = await fetch(apiUrl);
                    let result;
                    
                    if (!response.ok) {
                        // If specific employee fails, try without employee filter
                        if (employeeId) {
                            console.log(`âš ï¸ Employee query failed, retrying without employee filter...`);
                            const fallbackUrl = `${API_URL}/appointments/available-slots?business=${NASSIM_BUSINESS_ID}&date=${dateStr}`;
                            const fallbackResponse = await fetch(fallbackUrl);
                            if (!fallbackResponse.ok) continue;
                            result = await fallbackResponse.json();
                            if (!result.success || !result.data) continue;
                        } else {
                            continue;
                        }
                    } else {
                        result = await response.json();
                        if (!result.success || !result.data || !Array.isArray(result.data)) continue;
                    }

                    // Filter available slots
                    let availableSlots = result.data
                        .filter(s => s.available === true)
                        .sort((a, b) => timeToMinutes(a.time) - timeToMinutes(b.time));

                    console.log(`   Found ${availableSlots.length} available slots`);

                    // For today, suggest IMMEDIATE booking if possible (current time rounded up)
                    let immediateBookingTime = null;
                    if (isToday && availableSlots.length > 0) {
                        // Calculate immediate next available time (round up to nearest 5 minutes)
                        const immediateMinutes = Math.ceil((currentTotalMinutes + 5) / 5) * 5;
                        const immediateHour = Math.floor(immediateMinutes / 60);
                        const immediateMin = immediateMinutes % 60;
                        immediateBookingTime = `${String(immediateHour).padStart(2, '0')}:${String(immediateMin).padStart(2, '0')}`;
                        
                        const firstSlotMinutes = timeToMinutes(availableSlots[0].time);
                        console.log(`âš¡ Current: ${currentTime} (${currentTotalMinutes}min) â†’ Immediate: ${immediateBookingTime} (${immediateMinutes}min) vs First Slot: ${availableSlots[0].time} (${firstSlotMinutes}min)`);
                        
                        // Always use immediate booking if it's earlier than the first slot
                        if (immediateMinutes < firstSlotMinutes) {
                            const timeSaved = firstSlotMinutes - immediateMinutes;
                            console.log(`âœ¨ Immediate booking activated! ${immediateBookingTime} saves ${timeSaved} minutes`);
                        } else {
                            immediateBookingTime = null;
                            console.log(`â° Using first available slot ${availableSlots[0].time}`);
                        }
                    }

                    // If we have a suggested start time from schedule, prioritize slots at or after that time
                    if (suggestedStartTime) {
                        const suggestedMinutes = timeToMinutes(suggestedStartTime);
                        availableSlots = availableSlots.filter(s => timeToMinutes(s.time) >= suggestedMinutes);
                        console.log(`   Filtered to ${availableSlots.length} slots after ${suggestedStartTime}`);
                    }

                    // If immediate booking is available, use it directly without checking slots
                    if (immediateBookingTime && slotsNeeded === 1) {
                        console.log(`ğŸš€ Using immediate booking: ${immediateBookingTime}`);
                        
                        dateInput.value = dateStr;
                        timeInput.value = immediateBookingTime;
                        
                        // Select employee if needed
                        if (!employeeId && availableSlots[0]?.employee) {
                            employeeSelect.value = availableSlots[0].employee;
                        }
                        
                        const changeEvent = new Event('change', { bubbles: true });
                        dateInput.dispatchEvent(changeEvent);
                        timeInput.dispatchEvent(changeEvent);
                        employeeSelect.dispatchEvent(changeEvent);

                        const displayDate = new Date(dateStr).toLocaleDateString('ar-SA', {
                            weekday: 'long', day: 'numeric', month: 'long'
                        });
                        
                        const employeeName = employeeSelect.options[employeeSelect.selectedIndex]?.text || 'Ø£ÙŠ Ø­Ù„Ø§Ù‚';
                        const serviceNames = services.map(s => s.name || s.serviceName).join(', ') || 'Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©';
                        
                        if (window.showNotification) {
                            window.showNotification(`âš¡ Ø­Ø¬Ø² ÙÙˆØ±ÙŠ: ${displayDate} Ø§Ù„Ø³Ø§Ø¹Ø© ${immediateBookingTime}`, 'success');
                        }

                        if (btn) {
                            btn.disabled = false;
                            btn.innerHTML = 'âš¡ ØªÙ… - Ø­Ø¬Ø² ÙÙˆØ±ÙŠ';
                            btn.style.opacity = '1';
                            setTimeout(() => { btn.innerHTML = 'âœ¨ Ø§Ù‚ØªØ±Ø­ Ø£Ù‚Ø±Ø¨ Ù…ÙˆØ¹Ø¯'; }, 3000);
                        }
                        return;
                    }

                    // Find consecutive slots (normal flow)
                    for (let i = 0; i <= availableSlots.length - slotsNeeded; i++) {
                        const startSlot = availableSlots[i];
                        const startMinutes = timeToMinutes(startSlot.time);

                        // Skip slots in the past
                        if (isToday && startMinutes <= currentTotalMinutes) continue;

                        // Check for sequence
                        let isSequenceAvailable = true;
                        for (let j = 1; j < slotsNeeded; j++) {
                            const nextSlot = availableSlots[i + j];
                            if (!nextSlot) {
                                isSequenceAvailable = false;
                                break;
                            }
                            const expectedMinutes = startMinutes + (j * 30);
                            
                            if (timeToMinutes(nextSlot.time) !== expectedMinutes) {
                                isSequenceAvailable = false;
                                break;
                            }
                        }

                        if (isSequenceAvailable) {
                            // Found a valid sequence!
                            console.log(`âœ… [Suggest] Found sequence starting at ${startSlot.time} on ${dateStr}`);
                            
                            // Fill the form fields
                            dateInput.value = dateStr;
                            timeInput.value = startSlot.time;
                            
                            // If no specific employee was selected, select the first available from this slot
                            if (!employeeId && startSlot.employee) {
                                employeeSelect.value = startSlot.employee;
                                console.log(`ğŸ‘¤ Auto-selected employee: ${startSlot.employee}`);
                            }
                            
                            // Trigger change events to update the UI
                            const changeEvent = new Event('change', { bubbles: true });
                            dateInput.dispatchEvent(changeEvent);
                            timeInput.dispatchEvent(changeEvent);
                            employeeSelect.dispatchEvent(changeEvent);

                            const displayDate = new Date(dateStr).toLocaleDateString('ar-SA', {
                                weekday: 'long', day: 'numeric', month: 'long'
                            });
                            
                            const employeeName = employeeSelect.options[employeeSelect.selectedIndex]?.text || 'Ø£ÙŠ Ø­Ù„Ø§Ù‚';
                            const serviceNames = services.map(s => s.name || s.serviceName).join(', ') || 'Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©';
                            
                            // Show success notification instead of alert
                            if (window.showNotification) {
                                window.showNotification(`âœ… ØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ù…ÙˆØ¹Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹: ${displayDate} Ø§Ù„Ø³Ø§Ø¹Ø© ${startSlot.time}`, 'success');
                            }

                            if (btn) {
                                btn.disabled = false;
                                btn.innerHTML = 'âœ… ØªÙ… Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­';
                                btn.style.opacity = '1';
                                
                                // Reset button text after 3 seconds
                                setTimeout(() => {
                                    btn.innerHTML = 'âœ¨ Ø§Ù‚ØªØ±Ø­ Ø£Ù‚Ø±Ø¨ Ù…ÙˆØ¹Ø¯';
                                }, 3000);
                            }
                            return;
                        }
                    }
                }

                alert(`Ø¹Ø°Ø±Ø§Ù‹ØŒ Ù„Ù… Ù†Ø¬Ø¯ ÙØªØ±Ø© Ù…ØªØµÙ„Ø© Ø´Ø§ØºØ±Ø© Ù„Ù…Ø¯Ø© ${totalDuration} Ø¯Ù‚ÙŠÙ‚Ø© ÙÙŠ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ† Ø§Ù„Ù‚Ø§Ø¯Ù…ÙŠÙ†.\nÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹ Ø£Ùˆ ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ø®Ø¯Ù…Ø§Øª.`);
            } catch (error) {
                console.error('âŒ [Suggest] Error:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…ÙˆØ¹Ø¯');
            } finally {
                if (btn) {
                    btn.disabled = false;
                    btn.innerHTML = 'âœ¨ Ø§Ù‚ØªØ±Ø­ Ø£Ù‚Ø±Ø¨ Ù…ÙˆØ¹Ø¯';
                    btn.style.opacity = '1';
                }
            }
        };
        console.log('âœ… Smart Function defined inline at:', new Date().toISOString());
    </script>
</head>
<body>
    <!-- Splash Screen / Welcome Logo Animation -->
    <div id="splashScreen" class="splash-screen">
        <div class="splash-content">
            <img src="/nassim/logo.jpg" alt="Nassim Coiffeur" class="splash-logo">
            <div class="splash-text">Nassim Coiffeur</div>
            <div class="loading-dots">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </div>

    <!-- Main Home Page -->
    <div id="homePage" style="display: none;">
        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <img src="/nassim/logo.jpg" alt="Nassim Logo" class="header-logo">
                <h1 class="header-title">Nassim Coiffeur</h1>
                <div class="header-actions">
                    <button class="header-icon-btn" onclick="showNotifications()">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="22" height="22">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/>
                        </svg>
                        <span class="notification-badge"></span>
                    </button>
                    <button class="header-icon-btn" onclick="document.getElementById('searchInput').focus()">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="22" height="22">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="search-box">
                <svg class="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" width="20" height="20">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                </svg>
                <input type="text" class="search-input" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø®Ø¯Ù…Ø© Ø£Ùˆ Ø­Ù„Ø§Ù‚..." id="searchInput">
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div id="installPromptContainer" class="install-cta hidden">
                <div class="install-cta-content">
                    <div class="install-cta-icon">ğŸ“±</div>
                    <div>
                        <p class="install-cta-title">Ø«Ø¨Øª ØªØ·Ø¨ÙŠÙ‚ Nassim</p>
                        <p class="install-cta-desc">Ø§Ø­ÙØ¸ Ø§Ù„ØµØ§Ù„ÙˆÙ† ÙƒØªØ·Ø¨ÙŠÙ‚ Ø¹Ù„Ù‰ Ù‡Ø§ØªÙÙƒ Ù„Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø³Ø±ÙŠØ¹</p>
                    </div>
                </div>
                <button class="install-cta-button" onclick="promptPWAInstall()">ØªØ«Ø¨ÙŠØª Ø§Ù„Ø¢Ù†</button>
            </div>

            <!-- Contact Info Section -->
            <div class="contact-info-section">
                <a href="https://www.tiktok.com/@elsoultannassim3" target="_blank" class="contact-card-square contact-card-tiktok">
                    <div class="contact-card-icon">
                        <i class="fab fa-tiktok"></i>
                    </div>
                    <div class="contact-card-details">
                        <span class="contact-card-title">Ø­Ø³Ø§Ø¨ TikTok Ø§Ù„Ø±Ø³Ù…ÙŠ</span>
                        <span class="contact-card-handle">@elsoultannassim3</span>
                    </div>
                </a>
                <a href="https://www.facebook.com/NassimCoiffeur47" target="_blank" rel="noopener noreferrer" class="contact-card-square contact-card-facebook">
                    <div class="contact-card-icon">
                        <i class="fab fa-facebook-f"></i>
                    </div>
                    <div class="contact-card-details">
                        <span class="contact-card-title">ØµÙØ­Ø© Facebook</span>
                        <span class="contact-card-handle">NassimCoiffeur47</span>
                    </div>
                </a>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <div class="quick-action" onclick="showTimeline()">
                    <div class="quick-action-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                        </svg>
                    </div>
                    <span class="quick-action-label">Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ</span>
                </div>
                <div class="quick-action" onclick="showRating()">
                    <div class="quick-action-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"/>
                        </svg>
                    </div>
                    <span class="quick-action-label">ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø®Ø¯Ù…Ø©</span>
                </div>
                <div class="quick-action" onclick="handleReferFriend()">
                    <div class="quick-action-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"/>
                        </svg>
                    </div>
                    <span class="quick-action-label">Ø¥Ø­Ø§Ù„Ø© ØµØ¯ÙŠÙ‚</span>
                </div>
                <div class="quick-action" onclick="showShop()">
                    <div class="quick-action-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/>
                        </svg>
                    </div>
                    <span class="quick-action-label">Ø§Ù„Ù…ØªØ¬Ø±</span>
                </div>
                <div class="quick-action" onclick="showCoins()">
                    <div class="quick-action-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    <span class="quick-action-label">Ø§Ù„Ø¹Ù…Ù„Ø§Øª</span>
                </div>
                <div class="quick-action" onclick="showBookingHistory()">
                    <div class="quick-action-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    <span class="quick-action-label">Ø­Ø¬ÙˆØ²Ø§ØªÙŠ</span>
                </div>
                <div class="quick-action" onclick="openLocation()">
                    <div class="quick-action-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                        </svg>
                    </div>
                    <span class="quick-action-label">Ø§Ù„Ù…ÙˆÙ‚Ø¹</span>
                </div>
            </div>
            
            <!-- Enable Notifications Banner -->
            <div id="enableNotificationsBanner" class="notifications-banner" style="display: none;">
                <div class="banner-content">
                    <div class="banner-icon">ğŸ””</div>
                    <div class="banner-text">
                        <h4>ÙØ¹Ù‘Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</h4>
                        <p>Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ ØªØ­Ø¯ÙŠØ«Ø§Øª ÙÙˆØ±ÙŠØ© Ø¹Ù†Ø¯ ØªØ£ÙƒÙŠØ¯ Ù…ÙˆØ§Ø¹ÙŠØ¯Ùƒ</p>
                    </div>
                </div>
                <div class="banner-actions">
                    <button class="banner-btn primary" onclick="requestNotificationPermission()">ØªÙØ¹ÙŠÙ„</button>
                    <button class="banner-btn secondary" onclick="dismissNotificationBanner()">Ù„Ø§Ø­Ù‚Ø§Ù‹</button>
                </div>
            </div>

            <!-- Loyalty Points Card -->
            <div class="loyalty-card">
                <div class="loyalty-content">
                    <div class="loyalty-icon">â­</div>
                    <div class="loyalty-info">
                        <div class="loyalty-points" id="loyaltyPoints">0</div>
                        <div class="loyalty-label">Ù†Ù‚Ø§Ø· Ø§Ù„ÙˆÙ„Ø§Ø¡</div>
                    </div>
                </div>
                <div class="loyalty-tier">
                    <span id="loyaltyTier">Ø¨Ø±ÙˆÙ†Ø²ÙŠ</span>
                    <span class="tier-badge">ğŸ¥‰</span>
                </div>
            </div>

            <!-- Specialists -->
            <div class="section-header">
                <h2 class="section-title">Ø§Ù„Ø­Ù„Ø§Ù‚ÙŠÙ†</h2>
                <button class="see-all-btn" onclick="showAllSpecialists()">Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</button>
            </div>
            
            <div class="specialists-grid" id="specialistsList">
                <!-- Skeleton Loaders -->
                <div class="skeleton-card">
                    <div class="skeleton skeleton-image"></div>
                    <div class="skeleton-content">
                        <div class="skeleton skeleton-title"></div>
                        <div class="skeleton skeleton-text"></div>
                    </div>
                </div>
                <div class="skeleton-card">
                    <div class="skeleton skeleton-image"></div>
                    <div class="skeleton-content">
                        <div class="skeleton skeleton-title"></div>
                        <div class="skeleton skeleton-text"></div>
                    </div>
                </div>
            </div>

            <!-- Services -->
            <div class="section-header">
                <h2 class="section-title">Ø§Ù„Ø®Ø¯Ù…Ø§Øª</h2>
                <button class="see-all-btn" onclick="showAllServices()">Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</button>
            </div>

            <div class="services-list" id="servicesList">
                <!-- Services will be loaded here -->
            </div>

            <!-- Latest Posts -->
            <div class="section-header">
                <h2 class="section-title">Ø¢Ø®Ø± Ø§Ù„Ø£Ø®Ø¨Ø§Ø±</h2>
                <button class="see-all-btn" onclick="showPosts()">Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</button>
            </div>

            <div class="posts-list" id="postsList">
                <!-- Posts will be loaded here -->
            </div>

            <!-- Rewards -->
            <div class="section-header">
                <h2 class="section-title">Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª</h2>
                <button class="see-all-btn" onclick="showRewards()">Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</button>
            </div>

            <div class="rewards-list" id="rewardsList">
                <!-- Rewards will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Posts Page -->
    <div id="postsPage" class="page-container hidden">
        <div class="page-header">
            <button class="back-btn-page" onclick="goBackToHome()">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="20" height="20">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                </svg>
            </button>
            <h1 class="page-title">ğŸ“¢ Ø¢Ø®Ø± Ø§Ù„Ø£Ø®Ø¨Ø§Ø±</h1>
        </div>

        <div id="allPostsList" class="posts-container">
            <!-- All posts will be loaded here -->
        </div>
    </div>

    <!-- Rewards Page -->
    <div id="rewardsPage" class="page-container hidden">
        <div class="page-header">
            <button class="back-btn-page" onclick="goBackToHome()">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="20" height="20">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                </svg>
            </button>
            <h1 class="page-title">ğŸ›ï¸ Ø§Ù„Ù…ØªØ¬Ø±</h1>
        </div>

        <!-- Shop Tabs -->
        <div class="shop-tabs">
            <button class="shop-tab active" data-tab="products" onclick="switchShopTab('products', this)">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="20" height="20">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
                </svg>
                Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
            </button>
            <button class="shop-tab" data-tab="rewards" onclick="switchShopTab('rewards', this)">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="20" height="20">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª
            </button>
        </div>

        <!-- Products Tab Content -->
        <div id="productsTabContent" class="shop-tab-content active">
            <div id="allProductsList" class="products-container">
                <!-- All products will be loaded here -->
            </div>
        </div>

        <!-- Rewards Tab Content -->
        <div id="rewardsTabContent" class="shop-tab-content">
            <!-- User Points -->
            <div class="user-points-card" onclick="showCoins()" style="cursor: pointer;">
                <div class="points-info">
                    <div class="points-value" id="userPoints">0</div>
                    <div class="points-label">Ù†Ù‚Ø§Ø·Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ© (Ø§Ø¶ØºØ· Ù„Ù„ØªÙØ§ØµÙŠÙ„)</div>
                </div>
                <div class="points-icon">â­</div>
            </div>

            <div id="allRewardsList" class="rewards-container">
                <!-- All rewards will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Coins Page -->
    <div id="coinsPage" class="page-container hidden">
        <div class="page-header">
            <button class="back-btn-page" onclick="goBackToHome()">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="20" height="20">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                </svg>
            </button>
            <h1 class="page-title">ğŸ’° Ø§Ù„Ø¹Ù…Ù„Ø§Øª</h1>
        </div>

        <!-- User Coins Balance -->
        <div class="coins-balance-card">
            <div class="balance-content">
                <div class="balance-icon">ğŸª™</div>
                <div class="balance-info">
                    <div class="balance-value" id="userCoins">0</div>
                    <div class="balance-label">Ø¹Ù…Ù„Ø§ØªÙƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ©</div>
                </div>
            </div>
            <!-- Pending Points Section -->
            <div id="pendingPoints" class="pending-points-section" style="display: none;">
                <!-- Will be populated by JS -->
            </div>
            <button class="buy-coins-btn" onclick="showBuyCoinsModal()">
                <span>+</span> Ø´Ø±Ø§Ø¡ Ø¹Ù…Ù„Ø§Øª
            </button>
        </div>

        <!-- Coins History -->
        <div class="section-header" style="margin: 24px 0 16px;">
            <h3>Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„Ø§Øª</h3>
        </div>
        <div id="coinsHistoryList" class="coins-history-container">
            <!-- Coins history will be loaded here -->
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <button class="nav-item active" onclick="showHome()" id="nav-home">
            <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
            </svg>
            <span class="nav-label">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
        </button>
        <button class="nav-item" onclick="showPosts()" id="nav-posts">
            <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"/>
            </svg>
            <span class="nav-label">Ø§Ù„Ø£Ø®Ø¨Ø§Ø±</span>
        </button>
        <button class="nav-item center" onclick="openBookingModal()" id="nav-booking">
            <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 11v6m-3-3h6" />
            </svg>
        </button>
        <button class="nav-item" onclick="showShop()" id="nav-shop">
            <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/>
            </svg>
            <span class="nav-label">Ø§Ù„Ù…ØªØ¬Ø±</span>
        </button>
        <button class="nav-item" onclick="showAccount()" id="nav-account">
            <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
            </svg>
            <span class="nav-label">Ø­Ø³Ø§Ø¨ÙŠ</span>
        </button>
    </nav>

    <!-- Booking Modal -->
    <div id="bookingModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ğŸ“… Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯ Ø¬Ø¯ÙŠØ¯</h2>
                <button class="close-btn" onclick="closeBookingModal()">&times;</button>
            </div>
            <form id="bookingForm">
                <div class="form-group">
                    <label class="form-label">Ø§Ø®ØªØ± Ø§Ù„Ø®Ø¯Ù…Ø§Øª (Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø¯Ù…Ø© Ù„Ø§Ø®ØªÙŠØ§Ø±Ù‡Ø§) *</label>
                    <div id="bookingServicesList" class="booking-services-grid"></div>
                    <small style="color: var(--text-secondary); display: block; margin-top: 8px;">ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø®ØªÙŠØ§Ø± Ø¹Ø¯Ø© Ø®Ø¯Ù…Ø§Øª</small>
                </div>

                <div id="selectedServices" class="booking-summary" style="display: none;">
                    <div class="summary-content">
                        <div class="summary-row">
                            <span class="summary-label">Ø¹Ø¯Ø¯ Ø§Ù„Ø®Ø¯Ù…Ø§Øª:</span>
                            <strong id="servicesCount">0</strong>
                        </div>
                        <div class="summary-row">
                            <span class="summary-label">Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©:</span>
                            <strong id="totalDuration">0 Ø¯Ù‚ÙŠÙ‚Ø©</strong>
                        </div>
                        <div class="summary-row total-price-row">
                            <span class="summary-label">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹:</span>
                            <strong id="totalPrice">0 Ø¯Ø¬</strong>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Ø§Ø®ØªØ± Ø§Ù„Ø­Ù„Ø§Ù‚ *</label>
                    <select id="employeeSelect" class="form-select" required>
                        <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø­Ù„Ø§Ù‚ --</option>
                    </select>
                </div>

                <div class="form-group">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <label class="form-label" style="margin-bottom: 0;">Ø§Ù„ØªØ§Ø±ÙŠØ® *</label>
                        <button type="button" id="suggestBtn" onclick="_callSuggestSafe()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 6px 14px; border-radius: 6px; font-size: 13px; cursor: pointer; font-weight: 600; box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3); transition: all 0.3s ease; display: flex; align-items: center; gap: 4px;">
                            <span>âœ¨</span>
                            <span>Ø§Ù‚ØªØ±Ø­ Ø£Ù‚Ø±Ø¨ Ù…ÙˆØ¹Ø¯</span>
                        </button>
                    </div>
                    <input type="date" id="appointmentDate" class="form-input" required onchange="loadAvailableSlots()" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;">
                </div>

                <div class="form-group">
                    <label class="form-label">Ø§Ù„ÙˆÙ‚Øª *</label>
                    <input type="time" id="appointmentTime" class="form-input" required style="font-size: 16px; padding: 14px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;">
                </div>

                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                    <div id="timeSlots" class="time-slots">
                        <div class="working-hours-info">
                            <div class="working-hours-header">
                                <span class="hours-icon">ğŸ•</span>
                                <h4>Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¹Ù…Ù„</h4>
                            </div>
                            <div class="working-hours-grid">
                                <div class="working-shift morning-shift">
                                    <div class="shift-icon">ğŸŒ…</div>
                                    <div class="shift-details">
                                        <span class="shift-label">Ø§Ù„ÙØªØ±Ø© Ø§Ù„ØµØ¨Ø§Ø­ÙŠØ©</span>
                                        <span class="shift-time">10:00 Øµ - 2:00 Ù…</span>
                                    </div>
                                </div>
                                <div class="working-shift evening-shift">
                                    <div class="shift-icon">ğŸŒ†</div>
                                    <div class="shift-details">
                                        <span class="shift-label">Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ù…Ø³Ø§Ø¦ÙŠØ©</span>
                                        <span class="shift-time">4:30 Ù… - 9:00 Ù…</span>
                                    </div>
                                </div>
                            </div>
                            <div class="restricted-time-notice">
                                <div class="notice-icon">âš ï¸</div>
                                <div class="notice-content">
                                    <div class="notice-title">Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¶ØºØ·</div>
                                    <div class="notice-time">5:40 Ù… - 9:00 Ù…</div>
                                    <div class="notice-action">
                                        <span class="notice-text">ÙŠØ±Ø¬Ù‰ Ø¯ÙØ¹ 100 Ø¯ÙŠÙ†Ø§Ø± Ø¬Ø²Ø§Ø¦Ø±ÙŠ</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</label>
                    <textarea id="appointmentNotes" rows="3" placeholder="Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø®Ø§ØµØ©ØŸ" style="resize: vertical;"></textarea>
                </div>

                <button type="submit" class="book-now-btn" id="confirmBookingBtn">
                    ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²
                </button>
            </form>
        </div>
    </div>

    <!-- Notifications Page -->
    <div id="notificationsPage" class="page-container hidden">
        <div class="page-header">
            <button class="back-btn-page" onclick="goBackToHome()">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="20" height="20">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                </svg>
            </button>
            <h1 class="page-title">ğŸ”” Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</h1>
        </div>

        <div class="notifications-container" id="notificationsList">
            <!-- Notifications will be loaded here -->
        </div>

        <div class="empty-notifications hidden">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="80" height="80">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/>
            </svg>
            <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</h3>
            <p>Ø³Ù†Ø¹Ù„Ù…Ùƒ Ø¨Ø£ÙŠ ØªØ­Ø¯ÙŠØ«Ø§Øª Ù…Ù‡Ù…Ø©</p>
        </div>
    </div>

    <!-- Booking History Page -->
    <div id="bookingHistoryPage" class="page-container hidden">
        <div class="page-header">
            <button class="back-btn-page" onclick="goBackToHome()">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="20" height="20">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                </svg>
            </button>
            <h1 class="page-title">ğŸ“… Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</h1>
        </div>

        <div class="booking-tabs">
            <button class="booking-tab active" onclick="filterBookings('all')">Ø§Ù„ÙƒÙ„</button>
            <button class="booking-tab" onclick="filterBookings('upcoming')">Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</button>
            <button class="booking-tab" onclick="filterBookings('completed')">Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©</button>
            <button class="booking-tab" onclick="filterBookings('cancelled')">Ø§Ù„Ù…Ù„ØºÙŠØ©</button>
        </div>

        <div id="bookingsList" class="bookings-container">
            <!-- Bookings will be loaded here -->
        </div>

        <div class="empty-bookings hidden">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="80" height="80">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø¬ÙˆØ²Ø§Øª</h3>
            <p>Ø§Ø¨Ø¯Ø£ Ø¨Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯Ùƒ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø¢Ù†</p>
            <button class="book-now-btn" onclick="openBookingModal()">Ø§Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†</button>
        </div>
    </div>

    <!-- Edit Profile Page -->
    <div id="editProfilePage" class="page-container hidden">
        <div class="page-header">
            <button class="back-btn-page" onclick="showAccount()">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="20" height="20">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                </svg>
            </button>
            <h1 class="page-title">âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</h1>
        </div>

        <form id="editProfileForm" class="edit-profile-form">
            <div class="form-group">
                <label class="form-label">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ *</label>
                <input type="text" id="editName" class="form-input" required>
            </div>

            <div class="form-group">
                <label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ *</label>
                <input type="tel" id="editPhone" class="form-input" required>
            </div>

            <div class="form-group">
                <label class="form-label">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                <input type="email" id="editEmail" class="form-input">
            </div>

            <button type="submit" class="book-now-btn">
                Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
            </button>
        </form>
    </div>

    <!-- Account Page -->
    <div id="accountPage" class="page-container hidden">
        <div class="account-header">
            <div class="profile-section">
                <div class="profile-avatar">
                    <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=200&h=200&fit=crop&crop=faces" alt="Profile" id="profileImage">
                </div>
                <h2 class="profile-name" id="profileName"></h2>
                <p class="profile-email" id="profileEmail"></p>
                <p class="profile-phone" id="profilePhone" style="color: #999; font-size: 14px; margin-top: 4px;"></p>
                
                <!-- Points Display in Account -->
                <div class="account-points-card" onclick="showCoins()" style="margin-top: 16px; background: linear-gradient(135deg, #2d2d2d 0%, #1a1a1a 100%); border-radius: 12px; padding: 12px 16px; display: flex; align-items: center; justify-content: space-between; cursor: pointer; border: 1px solid rgba(253, 185, 49, 0.2); box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #FFD700 0%, #FDB931 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; box-shadow: 0 2px 10px rgba(253, 185, 49, 0.3); color: #000;">
                            â­
                        </div>
                        <div>
                            <div style="color: #aaa; font-size: 12px; margin-bottom: 2px;">Ù†Ù‚Ø§Ø· Ø§Ù„ÙˆÙ„Ø§Ø¡</div>
                            <div style="color: #FDB931; font-weight: 800; font-size: 20px; text-shadow: 0 2px 4px rgba(0,0,0,0.3);" id="accountPagePoints">0</div>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px; background: rgba(253, 185, 49, 0.1); padding: 4px 10px; border-radius: 20px; border: 1px solid rgba(253, 185, 49, 0.2);">
                        <span style="color: #FDB931; font-size: 12px; font-weight: 700;" id="accountPageTier">Ø¨Ø±ÙˆÙ†Ø²ÙŠ</span>
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="14" height="14" style="color: #FDB931;">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                        </svg>
                    </div>
                </div>
            </div>
        </div>

        <!-- Account Menu -->
        <div class="account-menu">
            <div class="menu-section">
                <h3 class="menu-section-title">Ø§Ù„Ø­Ø³Ø§Ø¨</h3>
                
                <button class="menu-item" onclick="editProfile()">
                    <div class="menu-item-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                        </svg>
                    </div>
                    <div class="menu-item-content">
                        <span class="menu-item-title">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</span>
                        <span class="menu-item-subtitle">Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„Ø¨Ø±ÙŠØ¯ØŒ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</span>
                    </div>
                    <svg class="menu-item-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24" width="20" height="20">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                </button>

                <button class="menu-item" onclick="showBookingHistory()">
                    <div class="menu-item-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    <div class="menu-item-content">
                        <span class="menu-item-title">Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</span>
                        <span class="menu-item-subtitle">Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø­Ø¬ÙˆØ²Ø§ØªÙƒ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</span>
                    </div>
                    <svg class="menu-item-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24" width="20" height="20">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                </button>
            </div>

            <div class="menu-section">
                <h3 class="menu-section-title">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h3>
                
                <button class="menu-item" onclick="showNotificationSettings()">
                    <div class="menu-item-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/>
                        </svg>
                    </div>
                    <div class="menu-item-content">
                        <span class="menu-item-title">Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</span>
                        <span class="menu-item-subtitle">Ø¥Ø¯Ø§Ø±Ø© Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</span>
                    </div>
                    <svg class="menu-item-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24" width="20" height="20">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                </button>

                <button class="menu-item" onclick="toggleSalonHotline()">
                    <div class="menu-item-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                        </svg>
                    </div>
                    <div class="menu-item-content">
                        <span class="menu-item-title">Ø±Ù‚Ù… Ø§Ù„ØµØ§Ù„ÙˆÙ†</span>
                        <span class="menu-item-subtitle" id="salonHotlineToggleText">Ø§Ø¶ØºØ· Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø±Ù‚Ù…</span>
                    </div>
                    <svg class="menu-item-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24" width="20" height="20">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                </button>

                <div id="salonHotlineCard" class="secret-contact-card hidden">
                    <div class="secret-contact-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="28" height="28">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                        </svg>
                    </div>
                    <div class="secret-contact-content">
                        <p class="secret-contact-title">0556 46 81 96</p>
                        <p class="secret-contact-note">Ø±Ù‚Ù… Ø§Ù„ØµØ§Ù„ÙˆÙ†</p>
                        <a href="tel:+213556468196" class="secret-contact-link">Ø§ØªØµÙ„ Ø§Ù„Ø¢Ù†</a>
                    </div>
                </div>
            </div>

            <button class="logout-btn" onclick="logout()">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
                </svg>
                ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
            </button>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification"></div>

    <!-- AI Assistant Floating Icon - Wassim -->
    <div id="aiFloatingIcon" class="ai-floating-icon" title="Ø§Ø³Ø£Ù„ wassim - Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ" style="display: flex !important; visibility: visible !important; opacity: 1 !important;">
        <div class="wassim-avatar-container">
            <div class="wassim-avatar-circle" id="wassimAvatarCircle" style="background-image: url('/nassim/wassim-logo.jpg');">
                <div class="wassim-initial" id="wassimInitial">W</div>
            </div>
        </div>
        <input type="file" id="wassimImageUpload" accept="image/*" style="display: none;" onchange="handleWassimImageUpload(event)">
    </div>

    <!-- AI Chat Modal -->
    <div id="aiChatModal" class="ai-chat-modal hidden">
        <div class="ai-chat-header">
            <div class="ai-chat-header-content">
                <div class="ai-chat-icon">ğŸ¤–</div>
                <div class="ai-chat-header-text">
                    <h3>Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ</h3>
                    <p>Nassim Coiffeur</p>
                </div>
            </div>
            <button class="ai-chat-close" onclick="closeAIChat()">Ã—</button>
        </div>

        <div class="ai-chat-messages" id="aiChatMessages">
            <div class="ai-welcome-message">
                <div class="ai-welcome-icon">ğŸ¤–</div>
                <h3>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ!</h3>
                <p>Ø£Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø°ÙƒÙŠ ÙÙŠ ØµØ§Ù„ÙˆÙ† <strong>Nassim Coiffeur</strong>.<br>
                Ø§Ø³Ø£Ù„Ù†ÙŠ Ø¹Ù† Ø£ÙŠ Ø®Ø¯Ù…Ø©ØŒ Ø³Ø¹Ø±ØŒ Ø£Ùˆ Ø§Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯Ùƒ Ø¨Ø³Ù‡ÙˆÙ„Ø©!</p>
            </div>
        </div>

        <div class="ai-typing-indicator" id="aiTypingIndicator">
            <div class="ai-typing-dots">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>

        <div class="ai-chat-input-container">
            <div class="ai-chat-input-wrapper">
                <textarea 
                    id="aiChatInput" 
                    class="ai-chat-input" 
                    placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§..."
                    rows="1"
                ></textarea>
                <button class="ai-send-button" id="aiSendButton" onclick="sendAIMessage()">
                    â¤
                </button>
            </div>
        </div>
    </div>

    <!-- AI Stylist Modal -->
    <div id="aiStylistModal" class="ai-stylist-modal" style="display: none;">
        <div class="ai-stylist-content">
            <div class="ai-stylist-header">
                <button class="close-ai-btn" onclick="closeAIStylist()">âœ•</button>
                <h2>ğŸ¤– Ù…ØµÙ…Ù… AI Ù„Ù„Ø­Ù„Ø§Ù‚Ø©</h2>
                <p>Ø§ÙƒØªØ´Ù Ø£ÙØ¶Ù„ ØªØµÙÙŠÙØ© Ø´Ø¹Ø± ØªÙ†Ø§Ø³Ø¨Ùƒ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</p>
                <div class="ai-demo-badge">
                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                    </svg>
                    <span>Powered by Google Gemini AI</span>
                </div>
            </div>

            <div class="ai-stylist-body">
                <!-- Upload Section -->
                <div class="ai-upload-section">
                    <div class="upload-box" id="uploadBox">
                        <input type="file" id="aiImageInput" accept="image/*" onchange="handleAIImageUpload(event)" style="display: none;">
                        <label for="aiImageInput" class="upload-label">
                            <svg width="48" height="48" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                            </svg>
                            <span>Ø§Ù†Ù‚Ø± Ù„ØªØ­Ù…ÙŠÙ„ ØµÙˆØ±ØªÙƒ</span>
                            <small>Ø£Ùˆ Ø§Ø³Ø­Ø¨ Ø§Ù„ØµÙˆØ±Ø© Ù‡Ù†Ø§</small>
                        </label>
                        <div id="imagePreviewContainer" style="display: none;">
                            <img id="imagePreview" class="ai-image-preview" alt="Preview">
                            <button class="remove-image-btn" onclick="removeAIImage()">âœ•</button>
                        </div>
                    </div>
                </div>

                <!-- Style Selection -->
                <div class="ai-style-section">
                    <h3>Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„ØªØµÙÙŠÙØ© Ø§Ù„Ù…ÙØ¶Ù„Ø©</h3>
                    <div class="style-options">
                        <label class="style-option">
                            <input type="radio" name="hairStyle" value="classic" checked>
                            <span class="style-card">
                                <span class="style-icon">ğŸ‘”</span>
                                <span>ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ</span>
                            </span>
                        </label>
                        <label class="style-option">
                            <input type="radio" name="hairStyle" value="modern">
                            <span class="style-card">
                                <span class="style-icon">âœ¨</span>
                                <span>Ø¹ØµØ±ÙŠ</span>
                            </span>
                        </label>
                        <label class="style-option">
                            <input type="radio" name="hairStyle" value="fade">
                            <span class="style-card">
                                <span class="style-icon">ğŸ”¥</span>
                                <span>ÙÙŠØ¯</span>
                            </span>
                        </label>
                        <label class="style-option">
                            <input type="radio" name="hairStyle" value="beard">
                            <span class="style-card">
                                <span class="style-icon">ğŸ§”</span>
                                <span>Ù„Ø­ÙŠØ©</span>
                            </span>
                        </label>
                    </div>
                </div>

                <!-- Generate Button -->
                <button class="ai-generate-btn" onclick="generateAIHairstyle()" id="generateBtn">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                    </svg>
                    <span>ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØªØµÙÙŠÙØ© Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</span>
                </button>

                <!-- Loading State -->
                <div id="aiLoadingState" class="ai-loading-state" style="display: none;">
                    <div class="loading-spinner"></div>
                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ø³ÙŠÙ† ØµÙˆØ±ØªÙƒ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ...</p>
                    <small>ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ± ÙˆØ§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù…Ø®ØµØµØ©</small>
                </div>

                <!-- Results Section -->
                <div id="aiResultsSection" class="ai-results-section" style="display: none;">
                    <div class="ai-results-container">
                        <!-- Suggestions will be dynamically inserted here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Timeline Page -->
    <div id="timelinePage" class="page-modal" style="display: none;">
        <div class="modal-content full-page">
            <div class="modal-header">
                <button class="modal-back-btn" onclick="closeTimeline()">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                </button>
                <h2 class="modal-title">ğŸ“… Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ</h2>
                <div></div>
            </div>
            
            <div class="page-content">
                <div class="timeline-controls">
                    <label for="timelineDate" class="form-label">Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙŠÙˆÙ…</label>
                    <div class="date-input-group">
                        <input type="date" id="timelineDate" class="form-input">
                        <button type="button" class="btn-primary" onclick="refreshTimelineView()">ØªØ­Ø¯ÙŠØ«</button>
                    </div>
                </div>

                <div class="timeline-summary" id="timelineSummaryCards"></div>

                <div class="timeline-legend">
                    <span class="legend-item"><span class="legend-dot available"></span>Ù…ØªØ§Ø­</span>
                    <span class="legend-item"><span class="legend-dot booked"></span>Ù…Ø­Ø¬ÙˆØ²</span>
                    <button class="btn-expand-timeline" onclick="openFullscreenTimeline()">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="20" height="20">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"/>
                        </svg>
                        Ø¹Ø±Ø¶ Ø¹Ù…ÙˆØ¯ÙŠ
                    </button>
                </div>

                <!-- Horizontal Timeline View -->
                <div class="timeline-strip-container">
                    <div class="timeline-strip" id="timelineStrip">
                        <!-- Slots will be injected here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Fullscreen Vertical Timeline -->
    <div id="fullscreenTimelinePage" class="fullscreen-timeline-modal" style="display: none;">
        <div class="fullscreen-timeline-header">
            <button class="modal-back-btn" onclick="closeFullscreenTimeline()">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
            </button>
            <h2 class="modal-title">ğŸ“… Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ - Ø¹Ø±Ø¶ ÙƒØ§Ù…Ù„</h2>
            <div class="fullscreen-date-display" id="fullscreenDateDisplay"></div>
        </div>
        
        <div class="fullscreen-timeline-content">
            <div class="vertical-timeline-strip" id="verticalTimelineStrip">
                <!-- Will be populated by JS -->
            </div>
        </div>
    </div>

    <!-- Rating Page -->
    <div id="ratingPage" class="page-modal" style="display: none;">
        <div class="modal-content full-page">
            <div class="modal-header">
                <button class="modal-back-btn" onclick="closeRating()">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                </button>
                <h2 class="modal-title">â­ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø®Ø¯Ù…Ø©</h2>
                <div></div>
            </div>
            
            <div class="page-content rating-page-container">
                
                <!-- Step 1: Phone Lookup -->
                <div id="ratingLookupSection">
                    <div class="rating-intro">
                        <h3 class="section-subtitle">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ</h3>
                        <p class="section-description">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ Ù„Ø¹Ø±Ø¶ Ù…ÙˆØ§Ø¹ÙŠØ¯Ùƒ Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©</p>
                    </div>
                    <form onsubmit="handleRatingPhoneLookup(event)" class="rating-lookup-form">
                        <div class="form-group">
                            <label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                            <input type="tel" id="ratingPhoneNumber" class="form-input" placeholder="05XXXXXXXX" required pattern="[0-9]{10}" maxlength="10">
                        </div>
                        <button type="submit" class="btn-primary-large">Ø¨Ø­Ø« Ø¹Ù† Ù…ÙˆØ§Ø¹ÙŠØ¯</button>
                    </form>
                </div>

                <!-- Step 2: Select Appointment -->
                <div id="ratingAppointmentsSection" style="display: none;">
                    <div class="section-header-row">
                        <h3 class="section-subtitle">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¹Ø¯ Ù„Ù„ØªÙ‚ÙŠÙŠÙ…</h3>
                        <button type="button" class="btn-text" onclick="backToRatingLookup()">ØªØºÙŠÙŠØ± Ø§Ù„Ø±Ù‚Ù…</button>
                    </div>
                    <div id="ratingAppointmentsList" class="appointments-list">
                        <!-- Items will be injected here -->
                    </div>
                </div>

                <!-- Step 3: Rating Form -->
                <div id="ratingFormSection" style="display: none;">
                    <div id="ratingSelectedAppointmentDetails" class="selected-appointment-card">
                        <!-- Details injected here -->
                    </div>
                    
                    <form id="customerRatingForm" class="rating-form" onsubmit="handleCustomerRatingSubmit(event)">
                        <div class="form-group">
                            <label class="form-label">ØªÙ‚ÙŠÙŠÙ…Ùƒ</label>
                            <div class="rating-stars-large" id="ratingStarsContainer">
                                <span class="rating-star-large" data-rating="1" onclick="selectRatingStar(1)">â˜…</span>
                                <span class="rating-star-large" data-rating="2" onclick="selectRatingStar(2)">â˜…</span>
                                <span class="rating-star-large" data-rating="3" onclick="selectRatingStar(3)">â˜…</span>
                                <span class="rating-star-large" data-rating="4" onclick="selectRatingStar(4)">â˜…</span>
                                <span class="rating-star-large" data-rating="5" onclick="selectRatingStar(5)">â˜…</span>
                            </div>
                            <input type="hidden" id="ratingValueInput">
                        </div>

                        <div class="form-group">
                            <label class="form-label">Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙƒ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                            <textarea id="ratingComment" class="rating-comment-box" placeholder="Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ù‡Ù†Ø§..."></textarea>
                        </div>
                        
                        <!-- Hidden fields for submission -->
                        <input type="hidden" id="ratingTime">
                        <input type="hidden" id="ratingBarber">
                        <input type="hidden" id="ratingService">

                        <div class="form-actions">
                            <button type="button" class="btn-secondary" onclick="backToRatingAppointments()">Ø±Ø¬ÙˆØ¹</button>
                            <button type="submit" class="btn-primary-large">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</button>
                        </div>
                    </form>
                </div>

            </div>
        </div>
    </div>
                                <span class="star" data-rating="3" onclick="selectRatingStar(3)">â˜…</span>
                                <span class="star" data-rating="4" onclick="selectRatingStar(4)">â˜…</span>
    <!-- Notification Side Panel -->
    <div id="notificationPanel" class="notification-panel">
        <div class="panel-header">
            <h2>ğŸ”” Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</h2>
            <button class="panel-close" onclick="closeNotificationPanel()">Ã—</button>
        </div>
        <div class="panel-actions">
            <button class="mark-all-read-btn" onclick="markAllAsRead()">
                <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
                </svg>
                ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„ ÙƒÙ…Ù‚Ø±ÙˆØ¡
            </button>
            <button class="clear-all-btn" onclick="clearAllNotifications()">
                <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                    <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
                </svg>
                Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„
            </button>
        </div>
        <div id="notificationPanelList" class="panel-notifications-list">
            <!-- Notifications will be dynamically inserted here -->
        </div>
    </div>
    <div id="notificationPanelOverlay" class="panel-overlay" onclick="closeNotificationPanel()"></div>

    <script>
    // Simplified caller - function already defined inline above
    window._callSuggestSafe = function() {
        console.log('ğŸ” Caller invoked, checking function...');
        if (typeof window.suggestNearestAppointment === 'function') {
            console.log('âœ… Function found, calling...');
            window.suggestNearestAppointment();
        } else {
            console.error('âŒ Function NOT found after inline definition!');
            alert('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©ØŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„');
        }
    };
    </script>
    <script src="/nassim/nassim-v8.js"></script>
    <script src="/nassim/ai-wassim.js"></script>
    <script src="/nassim/ai-stylist.js"></script>
</body>
</html>
